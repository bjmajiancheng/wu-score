<!DOCTYPE html>
<html lang="en">
<head>
    <title>申请人信息填写</title>
    #parse("common/header.html")
</head>

<body>
#parse("common/banner.html")

<!-- 主体部分 -->
<div class="integral-main-box">

    <!-- 左部导航 -->
    #parse("common/lefter.html")
    <!-- </script> -->
    <!-- 中间二级导航 -->

    <!-- 内容展示区 -->
    <div class="integral-cont">
        <!-- 第二大部分 -->
        <!-- 表单部分 -->
        <!-- 示例title 面包屑导航 -->
        <div class="integral-grey-title-bar">
            <div class="title-bar-head">居住证积分</div>
            <div class="title-bar-after">申请人信息填写</div>
        </div>
        <!-- 内容描述title -->
        <div class="integral-desc-title">
            申请人信息填写
        </div>
        <!-- 示例title2 二级标题 -->
        <div class="integral-grey-title-bar title-bar2">
            <div class="title-bar-head title-bar-sfz">身份证信息</div>
        </div>
        <!-- 表单主体部分  用table实现布局 -->
        <div class="integral-cont-table-wrap">
            <form class="identityInfoForm" id="identityInfoForm">
                <table class="integral-cont-table">
                    <tr>
                        <td>身份证号：</td>
                        <td>
                            <input class="integral-input w450" type="text" id="idNumber" name="idNumber">
                            <!-- <div class="interal-main-btn m15">身份证上传</div> -->
                        </td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <div class="integral-idcard-img">
                                <img class="addImg pointer" src="${rc.contextPath}/$static.curr_ver()/img/IDcard1.png"
                                     onclick="integral.clickImg(this);" alt="">
                                <img class="preview" id="preview" alt="" name="pic" width="152" height="100"
                                     style="display:none;"/>
                                <input name="idcard1" type="file" class="upload_input"
                                       onchange="integral.change(this)"/>
                                <div class="pointer title_click" onclick="integral.clickImg(this);">点击上传身份证正面</div>
                                <div class="title_idcard" style="display:none;">身份证正面</div>
                                <div class="del_idcard" onclick="integral.deleteImg(this)" style="display:none;"></div>

                                <input name="id_card_positive" type="hidden"/>
                            </div>
                            <div class="integral-idcard-img">
                                <img class="addImg pointer" src="${rc.contextPath}/$static.curr_ver()/img/IDcard2.png"
                                     onclick="integral.clickImg(this);" alt="">
                                <img class="preview" id="back" alt="" name="pic" width="152" height="100"
                                     style="display:none;"/>
                                <input name="idcard2" type="file" class="upload_input"
                                       onchange="integral.change(this)"/>
                                <div class="pointer title_click" onclick="integral.clickImg(this);">点击上传身份证反面</div>
                                <div class="title_idcard" style="display:none;">身份证反面</div>
                                <div class="del_idcard" onclick="integral.deleteImg(this)" style="display:none;"></div>

                                <input name="id_card_opposite" type="hidden"/>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>姓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="name" id="name">
                        </td>
                    </tr>
                    <tr>
                        <td>性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别：</td>
                        <td>
                            <input class="input_radio" type="radio" name="sex" value="1"
                                   id="male">&nbsp;&nbsp;&nbsp;<label for="male">男</label>
                            <input class="input_radio ml30" type="radio" name="sex" value="0" id="female">&nbsp;&nbsp;&nbsp;<label
                                for="female">女</label>
                        </td>
                    </tr>
                    <tr>
                        <td>出生日期：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="birthday" id="birthday">
                        </td>
                    </tr>
                    <tr>
                        <td>年&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;龄：</td>
                        <td>
                            <input class="integral-input w450" type="text" id="age" name="age">
                        </td>
                    </tr>
                    <tr>
                        <td>民&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;族：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="nation" id="nation">
                        </td>
                    </tr>
                </table>
            </form>
        </div>
        <!-- 示例title2 二级标题 -->
        <div class="integral-grey-title-bar title-bar2">
            <div class="title-bar-head title-bar-hjqy">户籍迁移信息</div>
        </div>
        <!-- 表单主体部分  用table实现布局 -->
        <div class="integral-cont-table-wrap">
            <form class="houseMoveForm">
                <table class="integral-cont-table">
                    <tr>
                        <td>迁出地区：</td>
                        <td>
                            <select name="moveProvince" id="moveProvince">
                                <option value="0">请选择</option>
                            </select>
                            &nbsp;&nbsp;省
                            <select class="ml40" name="moveCity" id="moveCity">
                                <option value="0">请选择</option>
                            </select>
                            &nbsp;&nbsp;市
                            <select class="ml40" name="moveRegion" id="moveRegion">
                                <option value="0">请选择</option>
                            </select>
                            &nbsp;&nbsp;区
                        </td>
                    </tr>
                    <tr>
                        <td>迁出地地址：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="moveAddress" id="moveAddress">
                        </td>
                    </tr>
                    <tr>
                        <td>现户籍登记机关：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="moveRegisteredOffice"
                                   id="moveRegisteredOffice">
                        </td>
                    </tr>
                    <tr>
                        <td>现户口性质：</td>
                        <td>
                            <select name="houseNature" id="houseNature">
                                <option>请选择</option>
                                <option value="1">未落常住户口</option>
                                <option value="2">非农业家庭户口</option>
                                <option value="3">农业家庭户口</option>
                                <option value="4">非农业集体户口</option>
                                <option value="5">农业集体户口</option>
                                <option value="6">自理口粮户口</option>
                                <option value="7">寄住户口</option>
                                <option value="8">暂住户口</option>
                                <option value="9">地方城镇居民户口</option>
                                <option value="10">其他户口</option>
                            </select>
                            <span class="integral-td-title ml50">落户性质：</span>
                            <select name="settledNature" id="settledNature">
                                <option>请选择</option>
                                <option value="1">本单位集体户口</option>
                                <option value="2">非本单位集体户口</option>
                                <option value="3">家庭户口</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>迁入户籍登记机关：</td>
                        <td>
                            <select name="registeredOffice" id="registeredOffice">
                                <option value="0">请选择</option>
                            </select>
                            <select class="ml50" name="registeredRegion" id="registeredRegion">
                                <option value="0">请选择</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>迁入地址详细地址：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="address" id="address">
                        </td>
                    </tr>
                    <tr>
                        <td>证明收件人：</td>
                        <td>
                            <input class="integral-input w200" placeholder="户口准予迁入证明快递收件人" type="text" name="witness"
                                   id="witness">
                            <span class="integral-td-title ml50">电话：</span>
                            <input class="integral-input w200" type="text" name="witnessPhone" id="witnessPhone">
                        </td>
                    </tr>
                    <tr>
                        <td>证明收件地址：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="witnessAddress" id="witnessAddress">
                        </td>
                    </tr>
                    <tr>
                        <td>拟落户地区：</td>
                        <td>
                            <select name="region" id="region">
                                <option value="21">和平区</option>
                                <option value="22">河东区</option>
                                <option value="23">河西区</option>
                                <option value="24">南开区</option>
                                <option value="25">河北区</option>
                                <option value="26">红桥区</option>
                                <option value="27">东丽区</option>
                                <option value="28">西青区</option>
                                <option value="29">津南区</option>
                                <option value="30">北辰区</option>
                                <option value="31">武清区</option>
                                <option value="32">宝坻区</option>
                                <option value="33">滨海新区</option>
                                <option value="34">宁河区</option>
                                <option value="35">静海区</option>
                                <option value="36">蓟州区</option>
                            </select>
                            <span class="integral-td-title ml50">婚姻状况：</span>
                            <select name="marriageStatus" id="marriageStatus">
                                <option value="1">已婚</option>
                                <option value="2">未婚</option>
                                <option value="3">丧偶</option>
                                <option value="4">离婚</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>有无子女</td>
                        <td>
                            <input class="input_radio" type="radio" name="haveSon" value="1" id="haveSon">&nbsp;&nbsp;&nbsp;<label
                                for="haveSon">有</label>
                            <input class="input_radio ml30" type="radio" name="haveSon" value="2" id="haveNoSon">&nbsp;&nbsp;&nbsp;<label
                                for="haveNoSon">无</label>
                            <span class="integral-td-title ml50">子女数量：</span>
                            <input class="integral-input w200" type="text" placeholder="无子女数量可不填" name="sonNumber"
                                   id="sonNumber">
                        </td>
                    </tr>
                </table>
            </form>
            <!-- 上边选中子女 为有 校验下方子女表 -->
            <div id="children-table">
                <!-- table表格部分1 子女关系表 -->
                <form class="houseRelationshipsForm">
                    <table class="integral-table border-add integral-cont-table houseRelationships">
                        <tr>
                            <th width="50"></th>
                            <th>与本人关系</th>
                            <th>姓名</th>
                            <th width="281">身份证号</th>
                            <th width="100">是否随迁</th>
                            <th>文化程度</th>
                        </tr>
                        <tr class="houseRelationship">
                            <td>
                                <input type="checkbox" name="check" class="checkRelation">
                            </td>
                            <td>
                                <select name="relationship">
                                    <option value="子">子</option>
                                    <option value="女">女</option>
                                    <option value="配偶">配偶</option>
                                </select>
                            </td>
                            <td>
                                <input class="table_add_input" type="text" name="name">
                            </td>
                            <td>
                                <input class="table_add_input" type="text" name="idNumber">
                            </td>
                            <td>
                                <input type="radio" name="isRemove" value="1" id="radio11"><label
                                    for="radio11">是</label><input class="m15" type="radio" name="isRemove" value="2"
                                                                  id="radio12"><label for="radio12">否</label>
                            </td>
                            <td>
                                <input class="table_add_input" type="text" name="cultureDegree">
                            </td>
                        </tr>
                    </table>
                </form>
                <!-- 子女关系表 控制按钮 -->
                <div class="integral-paging-device-wrap">
                    <!--  -->
                    <div class="interal-main-btn m15 fr mt10" id="addRelation">增加</div>
                    <div class="interal-main-btn m15 fr mt10" id="delRelation">删除</div>
                </div>
            </div>
        </div>
        <!-- 示例title2 二级标题 -->
        <div class="integral-grey-title-bar title-bar2">
            <div class="title-bar-head title-bar-other">其他信息</div>
        </div>
        <!-- 表单主体部分  用table实现布局 -->
        <div class="integral-cont-table-wrap">
            <form class="houseOtherForm">
                <table class="integral-cont-table">
                    <tr>
                        <td>申请人类型：</td>
                        <td>
                            <input class="input_radio" type="radio" name="applicantType" value="1" id="radio13">&nbsp;&nbsp;&nbsp;
                            <label for="radio13">企业员工</label>
                            <input class="input_radio ml30" type="radio" name="applicantType" value="2" id="radio14">&nbsp;&nbsp;&nbsp;
                            <label for="radio14">投资者</label>
                            <input class="input_radio ml30" type="radio" name="applicantType" value="3" id="radio15">&nbsp;&nbsp;&nbsp;
                            <label for="radio15">个体商户</label>
                            <input class="input_radio ml30" type="radio" name="applicantType" value="4" id="radio151">&nbsp;&nbsp;&nbsp;
                            <label for="radio151">事业单位</label>
                        </td>
                    </tr>
                    <tr>
                        <td>政治面貌：</td>
                        <td>
                            <select name="politicalStatus" id="politicalStatus">
                                <option value="13" selected>群众</option>
                                <option value="1">中共党员</option>
                                <option value="2">中共预备党员</option>
                                <option value="3">共青团员</option>
                                <option value="4">民革会员</option>
                                <option value="5">民盟盟员</option>
                                <option value="6">民建会员</option>
                                <option value="7">民进会员</option>
                                <option value="8">农工党党员</option>
                                <option value="9">致公党党员</option>
                                <option value="10">九三学社社员</option>
                                <option value="11">台盟盟员</option>
                                <option value="12">无党派民主人士</option>
                            </select>
                            <span class="integral-td-title ml50">军人立功：</span>
                            <select name="soldierMeritorious" id="soldierMeritorious">
                                <!--<option value="0">无</option>
                                <option value="1">一等功</option>
                                <option value="2">二等功</option>
                                <option value="3">三等功</option>-->
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>文化程度：</td>
                        <td>
                            <select name="cultureDegree" id="cultureDegree">
                                <!--<option value="1">本科及以上</option>
                                <option value="2">大专</option>
                                <option value="3">高级技工学校</option>
                                <option value="4">其他</option>-->
                            </select>
                            <span class="integral-td-title ml50">学位：</span>
                            <select name="degree" id="degree">
                                <option value="0">无</option>
                                <option value="1">博士后</option>
                                <option value="2">名誉博士</option>
                                <option value="3">博士</option>
                                <option value="4">硕士</option>
                                <option value="5">学士</option>
                                <option value="6">双学士</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>专业：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="profession" id="profession">
                        </td>
                    </tr>
                    <tr>
                        <td>现单位名称：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="companyName">
                        </td>
                    </tr>
                    <tr>
                        <td>现单位地址：</td>
                        <td>
                            <input class="integral-input w450" type="text" name="companyAddress">
                        </td>
                    </tr>
                    <tr>
                        <td>单位电话：</td>
                        <td>
                            <input class="integral-input w200" placeholder="户口准予迁入证明快递收件人" type="text"
                                   name="companyPhone">
                            <span class="integral-td-title ml50">本人电话：</span>
                            <input class="integral-input w200" type="text" name="selfPhone">
                        </td>
                    </tr>
                    <tr>
                        <td>居住证申领日期：</td>
                        <td>
                            <input class="integral-input w200" type="text" name="applicationDate" id="applicationDate">
                        </td>
                    </tr>
                    <tr>
                        <td>社保缴纳：</td>
                        <td>
                            <input class="input_radio" type="radio" name="socialSecurityPay" value="1" id="redio1">&nbsp;&nbsp;&nbsp;
                            <label for="redio1">是</label>
                            <input class="input_radio ml30" type="radio" name="socialSecurityPay" value="2" id="redio2">&nbsp;&nbsp;&nbsp;
                            <label for="redio2">否</label>
                            <span class="grey-color">是否缴纳社保</span>
                        </td>
                    </tr>
                    <tr>
                        <td>公积金：</td>
                        <td>
                            <input class="input_radio" type="radio" name="providentFund" value="1" id="redio3">&nbsp;&nbsp;&nbsp;
                            <label for="redio3">是</label>
                            <input class="input_radio ml30" type="radio" name="providentFund" value="2" id="redio4">&nbsp;&nbsp;&nbsp;
                            <label for="redio4">否</label>
                            <span class="grey-color">是否参加住房公积金</span>
                        </td>
                    </tr>
                    <tr>
                        <td>缴纳情况：</td>
                        <td>
                            <input class="input_radio" type="radio" name="taxes" value="1" id="radio5">&nbsp;&nbsp;&nbsp;
                            <label for="radio5">是</label>
                            <input class="input_radio ml30" type="radio" name="taxes" value="2" id="radio6">&nbsp;&nbsp;&nbsp;
                            <label for="radio6">否</label>
                            <span class="grey-color">近3年在本市依法缴纳个人所得税累计10万元及以上</span>
                        </td>
                    </tr>
                    <tr>
                        <td>拘留记录：</td>
                        <td>
                            <input class="input_radio" type="radio" name="detention" value="1" id="radio7">&nbsp;&nbsp;&nbsp;
                            <label for="radio7">是</label>
                            <input class="input_radio ml30" type="radio" name="detention" value="2" id="radio8">&nbsp;&nbsp;&nbsp;
                            <label for="radio8">否</label>
                            <span class="grey-color">积分期间有无行政拘留记录</span>
                        </td>
                    </tr>
                    <tr>
                        <td>获刑记录：</td>
                        <td>
                            <input class="input_radio" type="radio" name="penalty" value="1" id="radio9">&nbsp;&nbsp;&nbsp;
                            <label for="radio9">是</label>
                            <input class="input_radio ml30" type="radio" name="penalty" value="2" id="radio10">&nbsp;&nbsp;&nbsp;
                            <label for="radio10">否</label>
                            <span class="grey-color">积分期间有无犯罪获刑记录</span>
                        </td>
                    </tr>
                    <tr>
                        <td>奖项荣誉称号：</td>
                        <td>
                            <select name="awardsTitle" id="awardsTitle" style="width:500px;">
                                <!--<option value="0">请选择</option>
                                <option value="1">拥有有效的中国发明专利</option>
                                <option value="2">获得党中央、国务院授予的奖项和荣誉称号</option>
                                <option value="3">获得省（自治区、直辖市）党委、政府或中央和国家机关部委等授予的奖项和荣誉称号</option>
                                <option value="3">获得省（自治区、直辖市）党委、政府或中央和国家机关部委等授予的奖项和荣誉称号</option>
                                <option value="4">获得省（自治区、直辖市）党委、政府或中央和国家机关部委等授予的劳动模范或先进工作者荣誉称号，并享受省部级劳动模范或先进工作者待遇
                                </option>-->
                            </select>
                        </td>
                    </tr>
                </table>
            </form>
        </div>

        <!-- 示例title2 二级标题 -->
        <div class="integral-grey-title-bar title-bar2">
            <div class="title-bar-head title-bar-zyzg">职业资格证书</div>
        </div>
        <!-- 表单主体部分  用table实现布局 -->
        <div class="integral-cont-table-wrap">
            <form class="houseProfessionForm">
                <table class="integral-cont-table">
                    <tr>
                        <td>职业资格项：</td>
                        <td>
                            <input class="input_radio" type="radio" name="professionType" value="1" id="radio16">&nbsp;&nbsp;&nbsp;
                            <label for="radio16">无</label>
                            <input class="input_radio ml30" type="radio" name="professionType" value="2" id="radio17">&nbsp;&nbsp;&nbsp;
                            <label for="radio17">具有职称</label>
                            <input class="input_radio ml30" type="radio" name="professionType" value="3" id="radio18">&nbsp;&nbsp;&nbsp;
                            <label for="radio18">具有职业资格</label>
                        </td>
                    </tr>
                    <tr>
                        <td>职称级别：</td>
                        <td>
                            <select name="jobTitleLevel" id="jobTitleLevel">
                                <option value="1">初级职称</option>
                                <option value="2">中级职称</option>
                                <option value="3">高级职称</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>职位：</td>
                        <td>
                            <input class="integral-input w200" type="text" name="jobPosition">
                            <span class="integral-td-title ml50">发证机关：</span>
                            <input class="integral-input w200" type="text" name="issuingAuthority">
                        </td>
                    </tr>
                    <tr>
                        <td>发证日期：</td>
                        <td>
                            <input class="integral-input w200" type="text" name="issuingDate" id="issuingDate">
                            <span class="integral-td-title ml50">证书编号：</span>
                            <input class="integral-input w200" type="text" name="certificateCode">
                        </td>
                    </tr>
                    <tr>
                        <td>职业资格级别：</td>
                        <td>
                            <select name="jobLevel" id="jobLevel">
                                <!--<option value="0">无</option>
                                <option value="1">高级职称</option>
                                <option value="2">中级职称</option>
                                <option value="3">初级职称</option>
                                <option value="4">高级技师(一级)</option>
                                <option value="5">技师(二级)</option>
                                <option value="6">高级工(三级)</option>
                                <option value="7">中级工(四级)</option>
                                <option value="8">初级工(五级)</option>-->
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>工种：</td>
                        <td>
                            <select name="jobType" id="jobType">
                                <!--<option value="0">请选择</option>
                                <option value="1">非常紧缺职业</option>
                                <option value="2">紧缺职业</option>
                                <option value="3">一般紧缺职业</option>-->
                            </select>
                        </td>
                    </tr>

                </table>
            </form>
        </div>

        <!-- 验证码和底部按钮 -->
        <table class="check-table">
            <tr>
                <td>
                    <span class="color-red">*</span>验证码：
                </td>
                <td>
                    <input class="integral-input w200" type="text" name="captcha">
                    <div class="checkimg">
                        <img id="captchaImg" src="${rc.contextPath}/captcha.jpg" alt="看不清点我" class="click_me">
                    </div>
                    <span class="click_me">看不清点我</span>
                </td>
            </tr>
        </table>
        <!-- 保存按钮 -->
        <div class="integral-bottom-btn-group">
            <div class="interal-main-btn big-btn m15" id="submitAndContinue">保存并继续录入</div>
            <div class="interal-main-btn big-btn ml50" id="submit">保存</div>
            <div class="interal-main-btn big-btn ml50" id="cancel">返回</div>
        </div>
    </div>
</div>

<!-- 底部栏 footer -->
#parse("common/footer.html")
</body>
<script type="text/javascript" src="${rc.contextPath}/$static.curr_ver()/js/jquery.form.min.js"></script>
<script type="text/javascript">
    var relation_idx = 1;

    $(function () {

        currPage("addIdentity");

        laydate.render({
            elem: '#birthday' //生日
            ,max: 0,
            change: function(value, date, endDate) {
                var date = new Date();
                var startDate = new Date(value);
                var newDate = date.getTime() - startDate.getTime();
                var age = Math.ceil(newDate / 1000 / 60 / 60 / 24 /365);
                if (isNaN(age)){
                    age = "";
                }
                $("#age").val(age);
            }
        });

        laydate.render({
            elem: '#issuingDate' //发证日期
            ,max: 0
        });

        laydate.render({
            elem: '#applicationDate' //居住证申领日期
            ,max: 0
        });

        //获取评分选项信息
        getResultData("${rc.contextPath}/indicator/getAllIndicators", {}, function(data){
            //1.年龄,2.受教育程度,3.专业技术、职业技能水平,4.社会保险,5.住房公积金,6.住房,7.在津连续居住年限,
            //8.职业（工种）,9.落户地区,10.纳税,11.婚姻情况,12.知识产权,13.奖项和荣誉称号,14.退役军人,15.守法诚信
            initIndicatorInfo(data["2"], $("#cultureDegree"));

            initIndicatorInfo(data["3"], $("#jobLevel"));

            initIndicatorInfo(data["8"], $("#jobType"));

            initIndicatorInfo(data["13"], $("#awardsTitle"));

            initIndicatorInfo(data["14"], $("#soldierMeritorious"));
        });

        //初始化省份信息
        regionChange(0, "moveProvince");

        $("#moveProvince").on("change",
            function () {
                regionChange($("#moveProvince").val(), "moveCity");
            }
        ).change();
        $("#moveCity").on("change",
            function () {
                regionChange($("#moveCity").val(), "moveRegion");
            }
        ).change();

        //添加户籍关系
        $("#addRelation").on("click",
            function () {
                var html = [];
                html.push('<tr class="houseRelationship">');
                html.push('<td><input type="checkbox" name="check" class="checkRelation"></td>');
                html.push('<td>');
                var relationshipOption = '<option value="子">子</option><option value="女">女</option><option value="配偶">配偶</option>';
                if($("#marriageStatus").val() == 2) {
                    relationshipOption = '<option value="子">子</option><option value="女">女</option>';
                }
                html.push('<select name="relationship">'+relationshipOption+'</select>');
                html.push('</td>');
                html.push('<td><input class="table_add_input" type="text" name="name"></td>');
                html.push('<td><input class="table_add_input" type="text" name="idNumber"></td>');
                html.push('<td><input type="radio" name="isRemove' + relation_idx + '" value="1" id="isRemove' + relation_idx + '_yes"><label for="isRemove' + relation_idx + '_yes">是</label>');
                html.push('<input class="m15" type="radio" name="isRemove' + relation_idx + '" value="2" id="isRemove' + relation_idx + '_no"><label for="isRemove' + relation_idx + '_no">否</label></td>');
                html.push('<td><input class="table_add_input" type="text" name="cultureDegree"></td>');
                html.push('</tr>');
                $(".houseRelationships").append(html.join(''));

                relation_idx = relation_idx + 1;
            }
        );

        $("#delRelation").on("click",
            function () {
                $(".checkRelation:checked").each(function () {
                    $(this).parents("tr").remove();
                });
            }
        );

        //提交
        $("#submit").on("click", submit);
        $("#submitAndContinue").on("click", submitAndContinue);

        //身份证正面上传
        $("input[name=idcard1]").on("change", function () {
            var form = $("<form>");
            form.attr('style', 'display:none');
            form.attr('method', 'post');
            form.attr('action', '${rc.contextPath}/fileUpload/uploadImage');
            form.attr('enctype', 'multipart/form-data');
            var file = $("input[name=idcard1]").clone();
            $(file).attr('name', 'file');
            $(form).append(file);

            $('body').append(form);

            $(form).ajaxSubmit(function (result) {
                var obj = JSON.parse(result);
                if (!obj.code) {
                    $("input[name=id_card_positive]").val(obj.data);
                } else {
                    layer.msg(obj.msg);
                }
            });
        });

        //身份证反面上传
        $("input[name=idcard2]").on("change", function () {
            var form = $("<form>");
            form.attr('style', 'display:none');
            form.attr('method', 'post');
            form.attr('action', '${rc.contextPath}/fileUpload/uploadImage');
            form.attr('enctype', 'multipart/form-data');
            var file = $("input[name=idcard2]").clone();
            $(file).attr('name', 'file');
            $(form).append(file);

            $('body').append(form);
            $(form).ajaxSubmit(function (result) {
                var obj = JSON.parse(result);
                if (!obj.code) {
                    $("input[name=id_card_opposite]").val(obj.data);
                } else {
                    layer.msg(obj.msg);
                }
            });
        });

        //初始化迁入户籍登记机关
        initOfficeInfo(0, $("#registeredOffice"));

        $("#registeredOffice").on("change", function () {
            initOfficeInfo($(this).val(), $("#registeredRegion"));
        }).change();

        $("#marriageStatus").on("change", function() {
            if($(this).val() == 2) {
                $("select[name=relationship]").each(function(){
                    if($(this).val() == '配偶') {
                        $(this).val('子');
                    }

                    $(this).find("option[value=配偶]").remove();
                });
            } else {
                $("select[name=relationship]").each(function(){
                    if($(this).find("option[value=配偶]").length == 0) {
                        $(this).append('<option value="配偶">配偶</option>');
                    }
                });
            }
        });

        /*$("#identityInfoForm").validate({
            rules:{

            }
        });*/

    });

    /**
     * 提交表单
     */
    function submit() {
        var formInfo = getFormInfo();
    }

    /**
     * 提交并继续录入
     */
    function submitAndContinue() {
        var formInfo = getFormInfo();
    }

    /**
     * 获取表单信息
     */
    function getFormInfo() {
        var identityInfo = serializeForm($(".identityInfoForm"));
        var houseMoveInfo = serializeForm($(".houseMoveForm"));

        var houseRelationshipInfos = [];
        //初始化家庭关系信息
        $(".houseRelationship").each(function () {
            var relationship = $(this).find("select[name=relationship]").val();
            var name = $(this).find("input[name=name]").val();
            var idNumber = $(this).find("input[name=idNumber]").val();
            var isRemove = $(this).find("input[type=radio]").val();
            var cultureDegree = $(this).find("input[name=cultureDegree]").val();

            var houseRelationship = {
                "relationship": relationship,
                "name": name,
                "idNumber": idNumber,
                "isRemove": isRemove,
                "cultureDegree": cultureDegree
            };
            houseRelationshipInfos.push(houseRelationship);
        });

        var houseOtherInfo = serializeForm($(".houseOtherForm"));
        var houseProfessionInfo = serializeForm($(".houseProfessionForm"));

        identityInfo["houseMoveModel"] = houseMoveInfo;
        identityInfo["houseRelationshipModelList"] = houseRelationshipInfos;
        identityInfo["houseOtherModel"] = houseOtherInfo;
        identityInfo["houseProfessionModel"] = houseProfessionInfo;

        var captcha = $("input[name=captcha]").val();

        var identityInfoJson = JSON.stringify(identityInfo);

        postResultData("${rc.contextPath}/identityInfo/addIdentityInfo", {"identityInfoJson": identityInfoJson, "captcha": captcha}, function(data){
            layer.msg('保存成功!!', {
                time: 1000
            }, function () {
                window.close();
            });
        });
    }

    /**
     * 省市区变更
     *
     * @param regionId
     */
    function regionChange(regionId, changeRegion) {
        if (regionId == 0 && changeRegion != "moveProvince") {
            return;
        }

        if (changeRegion == "moveCity") {
            $("#moveRegion").html('<option value="0">请选择</option>');
        }

        getResultData("${rc.contextPath}/region/child/regions/" + regionId, {}, function(data){
            var html = [];
            html.push('<option value="0">请选择</option>');
            if (data != undefined) {
                for (var i = 0; i < data.length; i++) {
                    html.push('<option value="' + data[i].id + '">' + data[i].name + '</option>');
                }
            }
            $("#" + changeRegion).html(html.join(''));
        });

    }

    /**
     * 初始化评分选项信息
     */
    function initIndicatorInfo(indicatorInfo, field) {
        if(indicatorInfo == undefined) {
            field.html('');
        }
        var indicatorItems = indicatorInfo.indicatorItems;

        if(indicatorItems == undefined || indicatorItems.length == 0) {
            field.html('');
        }
        var arr = new Array();
        for(var i=0; i<indicatorItems.length; i++) {
            var selected = '';
            if(indicatorItems[i].content == '无') {
                selected = " selected ";
            }
            arr.push('<option value="'+ indicatorItems[i].id +'" ' + selected + '>'+ indicatorItems[i].content +'</option>');
        }

        field.html(arr.join(''));
    }

    /**
     * 初始化迁入登记机关
     *
     */
    function initOfficeInfo(officeId, field) {
        getResultData("${rc.contextPath}/office/getOffices", {"parentId": officeId}, function (data) {
            var offices = data;
            var officeArr = new Array();
            for (var i = 0; i < offices.length; i++) {
                var office = offices[i];
                officeArr.push('<option value="' + office["id"] + '">' + office["name"] + '</option>');
            }
            field.html(officeArr.join(''));
        });
    }

</script>

</html>

